{
  "_type": "https://in-toto.io/Statement/v0.1",
  "predicateType": "https://cosign.sigstore.dev/attestation/vuln/v1",
  "subject": [
    {
      "name": "src/iac/",
      "digest": {
        "sha256": "b6b76c661fa2cc00e0069a79b018f3e2417a689f06d099ea7d325990b5b3af74"
      }
    }
  ],
  "predicate": {
  "invocation": {
    "parameters": null,
    "uri": "",
    "event_id": "",
    "builder.id": ""
  },
  "scanner": {
    "uri": "pkg:github/aquasecurity/trivy@0.67.2",
    "version": "0.67.2",
    "db": {
      "uri": "",
      "version": ""
    },
    "result": {
      "SchemaVersion": 2,
      "CreatedAt": "2025-11-12T20:01:10.768578427Z",
      "ArtifactName": "src/iac",
      "ArtifactType": "filesystem",
      "Results": [
        {
          "Target": ".",
          "Class": "config",
          "Type": "terraform",
          "MisconfSummary": {
            "Successes": 58,
            "Failures": 0
          }
        },
        {
          "Target": "main.tf",
          "Class": "config",
          "Type": "terraform",
          "MisconfSummary": {
            "Successes": 0,
            "Failures": 11
          },
          "Misconfigurations": [
            {
              "Type": "Terraform Security Check",
              "ID": "AVD-AWS-0086",
              "AVDID": "AVD-AWS-0086",
              "Title": "S3 Access block should block public ACL",
              "Description": "S3 buckets should block public ACLs on buckets and any objects they contain. By blocking, PUTs with fail if the object has any public ACL a.\n",
              "Message": "Public access block does not block public ACLs",
              "Namespace": "builtin.aws.s3.aws0086",
              "Query": "data.builtin.aws.s3.aws0086.deny",
              "Resolution": "Enable blocking any PUT calls with a public ACL specified",
              "Severity": "HIGH",
              "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0086",
              "References": [
                "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html",
                "https://avd.aquasec.com/misconfig/avd-aws-0086"
              ],
              "Status": "FAIL",
              "CauseMetadata": {
                "Resource": "aws_s3_bucket_public_access_block.app_bucket",
                "Provider": "AWS",
                "Service": "s3",
                "StartLine": 8,
                "EndLine": 8,
                "Code": {
                  "Lines": [
                    {
                      "Number": 5,
                      "Content": "resource \"aws_s3_bucket_public_access_block\" \"app_bucket\" {",
                      "IsCause": false,
                      "Annotation": "",
                      "Truncated": false,
                      "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket_public_access_block\"\u001b[0m \u001b[38;5;37m\"app_bucket\"\u001b[0m {",
                      "FirstCause": false,
                      "LastCause": false
                    },
                    {
                      "Number": 6,
                      "Content": "  bucket = aws_s3_bucket.app_bucket.id",
                      "IsCause": false,
                      "Annotation": "",
                      "Truncated": false,
                      "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = aws_s3_bucket.app_bucket.id",
                      "FirstCause": false,
                      "LastCause": false
                    },
                    {
                      "Number": 7,
                      "Content": "  ",
                      "IsCause": false,
                      "Annotation": "",
                      "Truncated": false,
                      "Highlighted": "  ",
                      "FirstCause": false,
                      "LastCause": false
                    },
                    {
                      "Number": 8,
                      "Content": "  block_public_acls       = false",
                      "IsCause": true,
                      "Annotation": "",
                      "Truncated": false,
                      "Highlighted": "  \u001b[38;5;245mblock_public_acls\u001b[0m       = \u001b[38;5;166mfalse",
                      "FirstCause": true,
                      "LastCause": true
                    },
                    {
                      "Number": 9,
                      "Content": "  block_public_policy     = false",
                      "IsCause": false,
                      "Annotation": "",
                      "Truncated": false,
                      "Highlighted": "\u001b[0m  \u001b[38;5;245mblock_public_policy\u001b[0m     = \u001b[38;5;166mfalse",
                      "FirstCause": false,
                      "LastCause": false
                    },
                    {
                      "Number": 10,
                      "Content": "  ignore_public_acls      = false",
                      "IsCause": false,
                      "Annotation": "",
                      "Truncated": false,
                      "Highlighted": "\u001b[0m  \u001b[38;5;245mignore_public_acls\u001b[0m      = \u001b[38;5;166mfalse",
                      "FirstCause": false,
                      "LastCause": false
                    },
                    {
                      "Number": 11,
                      "Content": "  restrict_public_buckets = false",
                      "IsCause": false,
                      "Annotation": "",
                      "Truncated": false,
                      "Highlighted": "\u001b[0m  \u001b[38;5;245mrestrict_public_buckets\u001b[0m = \u001b[38;5;166mfalse",
                      "FirstCause": false,
                      "LastCause": false
                    },
                    {
                      "Number": 12,
                      "Content": "}",
                      "IsCause": false,
                      "Annotation": "",
                      "Truncated": false,
                      "Highlighted": "\u001b[0m}",
                      "FirstCause": false,
                      "LastCause": false
                    }
                  ]
                },
                "Occurrences": [
                  {
                    "Resource": "aws_s3_bucket_public_access_block.app_bucket",
                    "Filename": "main.tf",
                    "Location": {
                      "StartLine": 5,
                      "EndLine": 12
                    }
                  }
                ]
              }
            },
            {
              "Type": "Terraform Security Check",
              "ID": "AVD-AWS-0087",
              "AVDID": "AVD-AWS-0087",
              "Title": "S3 Access block should block public policy",
              "Description": "S3 bucket policy should have block public policy to prevent users from putting a policy that enable public access.\n",
              "Message": "Public access block does not block public policies",
              "Namespace": "builtin.aws.s3.aws0087",
              "Query": "data.builtin.aws.s3.aws0087.deny",
              "Resolution": "Prevent policies that allow public access being PUT",
              "Severity": "HIGH",
              "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0087",
              "References": [
                "https://docs.aws.amazon.com/AmazonS3/latest/dev-retired/access-control-block-public-access.html",
                "https://avd.aquasec.com/misconfig/avd-aws-0087"
              ],
              "Status": "FAIL",
              "CauseMetadata": {
                "Resource": "aws_s3_bucket_public_access_block.app_bucket",
                "Provider": "AWS",
                "Service": "s3",
                "StartLine": 9,
                "EndLine": 9,
                "Code": {
                  "Lines": [
                    {
                      "Number": 5,
                      "Content": "resource \"aws_s3_bucket_public_access_block\" \"app_bucket\" {",
                      "IsCause": false,
                      "Annotation": "",
                      "Truncated": false,
                      "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket_public_access_block\"\u001b[0m \u001b[38;5;37m\"app_bucket\"\u001b[0m {",
                      "FirstCause": false,
                      "LastCause": false
                    },
                    {
                      "Number": 6,
                      "Content": "  bucket = aws_s3_bucket.app_bucket.id",
                      "IsCause": false,
                      "Annotation": "",
                      "Truncated": false,
                      "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = aws_s3_bucket.app_bucket.id",
                      "FirstCause": false,
                      "LastCause": false
                    },
                    {
                      "Number": 7,
                      "Content": "  ",
                      "IsCause": false,
                      "Annotation": "",
                      "Truncated": false,
                      "Highlighted": "  ",
                      "FirstCause": false,
                      "LastCause": false
                    },
                    {
                      "Number": 8,
                      "Content": "  block_public_acls       = false",
                      "IsCause": false,
                      "Annotation": "",
                      "Truncated": false,
                      "Highlighted": "  \u001b[38;5;245mblock_public_acls\u001b[0m       = \u001b[38;5;166mfalse",
                      "FirstCause": false,
                      "LastCause": false
                    },
                    {
                      "Number": 9,
                      "Content": "  block_public_policy     = false",
                      "IsCause": true,
                      "Annotation": "",
                      "Truncated": false,
                      "Highlighted": "\u001b[0m  \u001b[38;5;245mblock_public_policy\u001b[0m     = \u001b[38;5;166mfalse",
                      "FirstCause": true,
                      "LastCause": true
                    },
                    {
                      "Number": 10,
                      "Content": "  ignore_public_acls      = false",
                      "IsCause": false,
                      "Annotation": "",
                      "Truncated": false,
                      "Highlighted": "\u001b[0m  \u001b[38;5;245mignore_public_acls\u001b[0m      = \u001b[38;5;166mfalse",
                      "FirstCause": false,
                      "LastCause": false
                    },
                    {
                      "Number": 11,
                      "Content": "  restrict_public_buckets = false",
                      "IsCause": false,
                      "Annotation": "",
                      "Truncated": false,
                      "Highlighted": "\u001b[0m  \u001b[38;5;245mrestrict_public_buckets\u001b[0m = \u001b[38;5;166mfalse",
                      "FirstCause": false,
                      "LastCause": false
                    },
                    {
                      "Number": 12,
                      "Content": "}",
                      "IsCause": false,
                      "Annotation": "",
                      "Truncated": false,
                      "Highlighted": "\u001b[0m}",
                      "FirstCause": false,
                      "LastCause": false
                    }
                  ]
                },
                "Occurrences": [
                  {
                    "Resource": "aws_s3_bucket_public_access_block.app_bucket",
                    "Filename": "main.tf",
                    "Location": {
                      "StartLine": 5,
                      "EndLine": 12
                    }
                  }
                ]
              }
            },
            {
              "Type": "Terraform Security Check",
              "ID": "AVD-AWS-0088",
              "AVDID": "AVD-AWS-0088",
              "Title": "Unencrypted S3 bucket.",
              "Description": "S3 Buckets should be encrypted to protect the data that is stored within them if access is compromised.\n",
              "Message": "Bucket does not have encryption enabled",
              "Namespace": "builtin.aws.s3.aws0088",
              "Query": "data.builtin.aws.s3.aws0088.deny",
              "Resolution": "Configure bucket encryption",
              "Severity": "HIGH",
              "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0088",
              "References": [
                "https://docs.aws.amazon.com/AmazonS3/latest/userguide/bucket-encryption.html",
                "https://avd.aquasec.com/misconfig/avd-aws-0088"
              ],
              "Status": "FAIL",
              "CauseMetadata": {
                "Resource": "aws_s3_bucket.app_bucket",
                "Provider": "AWS",
                "Service": "s3",
                "StartLine": 1,
                "EndLine": 3,
                "Code": {
                  "Lines": [
                    {
                      "Number": 1,
                      "Content": "resource \"aws_s3_bucket\" \"app_bucket\" {",
                      "IsCause": true,
                      "Annotation": "",
                      "Truncated": false,
                      "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"app_bucket\"\u001b[0m {",
                      "FirstCause": true,
                      "LastCause": false
                    },
                    {
                      "Number": 2,
                      "Content": "  bucket = \"my-app-bucket\"",
                      "IsCause": true,
                      "Annotation": "",
                      "Truncated": false,
                      "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"my-app-bucket\"",
                      "FirstCause": false,
                      "LastCause": false
                    },
                    {
                      "Number": 3,
                      "Content": "}",
                      "IsCause": true,
                      "Annotation": "",
                      "Truncated": false,
                      "Highlighted": "\u001b[0m}",
                      "FirstCause": false,
                      "LastCause": true
                    }
                  ]
                }
              }
            },
            {
              "Type": "Terraform Security Check",
              "ID": "s3-bucket-logging",
              "AVDID": "AVD-AWS-0089",
              "Title": "S3 Bucket Logging",
              "Description": "Ensures S3 bucket logging is enabled for S3 buckets",
              "Message": "Bucket has logging disabled",
              "Namespace": "builtin.aws.s3.aws0089",
              "Query": "data.builtin.aws.s3.aws0089.deny",
              "Resolution": "Add a logging block to the resource to enable access logging",
              "Severity": "LOW",
              "PrimaryURL": "https://avd.aquasec.com/misconfig/s3-bucket-logging",
              "References": [
                "https://docs.aws.amazon.com/AmazonS3/latest/userguide/ServerLogs.html",
                "https://docs.aws.amazon.com/AmazonS3/latest/userguide/enable-server-access-logging.html",
                "https://avd.aquasec.com/misconfig/s3-bucket-logging"
              ],
              "Status": "FAIL",
              "CauseMetadata": {
                "Resource": "aws_s3_bucket.app_bucket",
                "Provider": "AWS",
                "Service": "s3",
                "StartLine": 1,
                "EndLine": 3,
                "Code": {
                  "Lines": [
                    {
                      "Number": 1,
                      "Content": "resource \"aws_s3_bucket\" \"app_bucket\" {",
                      "IsCause": true,
                      "Annotation": "",
                      "Truncated": false,
                      "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"app_bucket\"\u001b[0m {",
                      "FirstCause": true,
                      "LastCause": false
                    },
                    {
                      "Number": 2,
                      "Content": "  bucket = \"my-app-bucket\"",
                      "IsCause": true,
                      "Annotation": "",
                      "Truncated": false,
                      "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"my-app-bucket\"",
                      "FirstCause": false,
                      "LastCause": false
                    },
                    {
                      "Number": 3,
                      "Content": "}",
                      "IsCause": true,
                      "Annotation": "",
                      "Truncated": false,
                      "Highlighted": "\u001b[0m}",
                      "FirstCause": false,
                      "LastCause": true
                    }
                  ]
                }
              }
            },
            {
              "Type": "Terraform Security Check",
              "ID": "AVD-AWS-0090",
              "AVDID": "AVD-AWS-0090",
              "Title": "S3 Data should be versioned",
              "Description": "Versioning in Amazon S3 is a means of keeping multiple variants of an object in the same bucket.\n\nYou can use the S3 Versioning feature to preserve, retrieve, and restore every version of every object stored in your buckets.\n\nWith versioning you can recover more easily from both unintended user actions and application failures.\n\nWhen you enable versioning, also keep in mind the potential costs of storing noncurrent versions of objects. To help manage those costs, consider setting up an S3 Lifecycle configuration.\n",
              "Message": "Bucket does not have versioning enabled",
              "Namespace": "builtin.aws.s3.aws0090",
              "Query": "data.builtin.aws.s3.aws0090.deny",
              "Resolution": "Enable versioning to protect against accidental/malicious removal or modification",
              "Severity": "MEDIUM",
              "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0090",
              "References": [
                "https://docs.aws.amazon.com/AmazonS3/latest/userguide/Versioning.html",
                "https://aws.amazon.com/blogs/storage/reduce-storage-costs-with-fewer-noncurrent-versions-using-amazon-s3-lifecycle/",
                "https://avd.aquasec.com/misconfig/avd-aws-0090"
              ],
              "Status": "FAIL",
              "CauseMetadata": {
                "Resource": "aws_s3_bucket.app_bucket",
                "Provider": "AWS",
                "Service": "s3",
                "StartLine": 1,
                "EndLine": 3,
                "Code": {
                  "Lines": [
                    {
                      "Number": 1,
                      "Content": "resource \"aws_s3_bucket\" \"app_bucket\" {",
                      "IsCause": true,
                      "Annotation": "",
                      "Truncated": false,
                      "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"app_bucket\"\u001b[0m {",
                      "FirstCause": true,
                      "LastCause": false
                    },
                    {
                      "Number": 2,
                      "Content": "  bucket = \"my-app-bucket\"",
                      "IsCause": true,
                      "Annotation": "",
                      "Truncated": false,
                      "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"my-app-bucket\"",
                      "FirstCause": false,
                      "LastCause": false
                    },
                    {
                      "Number": 3,
                      "Content": "}",
                      "IsCause": true,
                      "Annotation": "",
                      "Truncated": false,
                      "Highlighted": "\u001b[0m}",
                      "FirstCause": false,
                      "LastCause": true
                    }
                  ]
                }
              }
            },
            {
              "Type": "Terraform Security Check",
              "ID": "AVD-AWS-0091",
              "AVDID": "AVD-AWS-0091",
              "Title": "S3 Access Block should Ignore Public ACL",
              "Description": "S3 buckets should ignore public ACLs on buckets and any objects they contain. By ignoring rather than blocking, PUT calls with public ACLs will still be applied but the ACL will be ignored.\n",
              "Message": "Public access block does not ignore public ACLs",
              "Namespace": "builtin.aws.s3.aws0091",
              "Query": "data.builtin.aws.s3.aws0091.deny",
              "Resolution": "Enable ignoring the application of public ACLs in PUT calls",
              "Severity": "HIGH",
              "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0091",
              "References": [
                "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html",
                "https://avd.aquasec.com/misconfig/avd-aws-0091"
              ],
              "Status": "FAIL",
              "CauseMetadata": {
                "Resource": "aws_s3_bucket_public_access_block.app_bucket",
                "Provider": "AWS",
                "Service": "s3",
                "StartLine": 10,
                "EndLine": 10,
                "Code": {
                  "Lines": [
                    {
                      "Number": 5,
                      "Content": "resource \"aws_s3_bucket_public_access_block\" \"app_bucket\" {",
                      "IsCause": false,
                      "Annotation": "",
                      "Truncated": false,
                      "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket_public_access_block\"\u001b[0m \u001b[38;5;37m\"app_bucket\"\u001b[0m {",
                      "FirstCause": false,
                      "LastCause": false
                    },
                    {
                      "Number": 6,
                      "Content": "  bucket = aws_s3_bucket.app_bucket.id",
                      "IsCause": false,
                      "Annotation": "",
                      "Truncated": false,
                      "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = aws_s3_bucket.app_bucket.id",
                      "FirstCause": false,
                      "LastCause": false
                    },
                    {
                      "Number": 7,
                      "Content": "  ",
                      "IsCause": false,
                      "Annotation": "",
                      "Truncated": false,
                      "Highlighted": "  ",
                      "FirstCause": false,
                      "LastCause": false
                    },
                    {
                      "Number": 8,
                      "Content": "  block_public_acls       = false",
                      "IsCause": false,
                      "Annotation": "",
                      "Truncated": false,
                      "Highlighted": "  \u001b[38;5;245mblock_public_acls\u001b[0m       = \u001b[38;5;166mfalse",
                      "FirstCause": false,
                      "LastCause": false
                    },
                    {
                      "Number": 9,
                      "Content": "  block_public_policy     = false",
                      "IsCause": false,
                      "Annotation": "",
                      "Truncated": false,
                      "Highlighted": "\u001b[0m  \u001b[38;5;245mblock_public_policy\u001b[0m     = \u001b[38;5;166mfalse",
                      "FirstCause": false,
                      "LastCause": false
                    },
                    {
                      "Number": 10,
                      "Content": "  ignore_public_acls      = false",
                      "IsCause": true,
                      "Annotation": "",
                      "Truncated": false,
                      "Highlighted": "\u001b[0m  \u001b[38;5;245mignore_public_acls\u001b[0m      = \u001b[38;5;166mfalse",
                      "FirstCause": true,
                      "LastCause": true
                    },
                    {
                      "Number": 11,
                      "Content": "  restrict_public_buckets = false",
                      "IsCause": false,
                      "Annotation": "",
                      "Truncated": false,
                      "Highlighted": "\u001b[0m  \u001b[38;5;245mrestrict_public_buckets\u001b[0m = \u001b[38;5;166mfalse",
                      "FirstCause": false,
                      "LastCause": false
                    },
                    {
                      "Number": 12,
                      "Content": "}",
                      "IsCause": false,
                      "Annotation": "",
                      "Truncated": false,
                      "Highlighted": "\u001b[0m}",
                      "FirstCause": false,
                      "LastCause": false
                    }
                  ]
                },
                "Occurrences": [
                  {
                    "Resource": "aws_s3_bucket_public_access_block.app_bucket",
                    "Filename": "main.tf",
                    "Location": {
                      "StartLine": 5,
                      "EndLine": 12
                    }
                  }
                ]
              }
            },
            {
              "Type": "Terraform Security Check",
              "ID": "AVD-AWS-0093",
              "AVDID": "AVD-AWS-0093",
              "Title": "S3 Access block should restrict public bucket to limit access",
              "Description": "S3 buckets should restrict public policies for the bucket. By enabling, the restrict_public_buckets, only the bucket owner and AWS Services can access if it has a public policy.\n",
              "Message": "Public access block does not restrict public buckets",
              "Namespace": "builtin.aws.s3.aws0093",
              "Query": "data.builtin.aws.s3.aws0093.deny",
              "Resolution": "Limit the access to public buckets to only the owner or AWS Services (eg; CloudFront)",
              "Severity": "HIGH",
              "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0093",
              "References": [
                "https://docs.aws.amazon.com/AmazonS3/latest/dev-retired/access-control-block-public-access.html",
                "https://avd.aquasec.com/misconfig/avd-aws-0093"
              ],
              "Status": "FAIL",
              "CauseMetadata": {
                "Resource": "aws_s3_bucket_public_access_block.app_bucket",
                "Provider": "AWS",
                "Service": "s3",
                "StartLine": 11,
                "EndLine": 11,
                "Code": {
                  "Lines": [
                    {
                      "Number": 5,
                      "Content": "resource \"aws_s3_bucket_public_access_block\" \"app_bucket\" {",
                      "IsCause": false,
                      "Annotation": "",
                      "Truncated": false,
                      "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket_public_access_block\"\u001b[0m \u001b[38;5;37m\"app_bucket\"\u001b[0m {",
                      "FirstCause": false,
                      "LastCause": false
                    },
                    {
                      "Number": 6,
                      "Content": "  bucket = aws_s3_bucket.app_bucket.id",
                      "IsCause": false,
                      "Annotation": "",
                      "Truncated": false,
                      "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = aws_s3_bucket.app_bucket.id",
                      "FirstCause": false,
                      "LastCause": false
                    },
                    {
                      "Number": 7,
                      "Content": "  ",
                      "IsCause": false,
                      "Annotation": "",
                      "Truncated": false,
                      "Highlighted": "  ",
                      "FirstCause": false,
                      "LastCause": false
                    },
                    {
                      "Number": 8,
                      "Content": "  block_public_acls       = false",
                      "IsCause": false,
                      "Annotation": "",
                      "Truncated": false,
                      "Highlighted": "  \u001b[38;5;245mblock_public_acls\u001b[0m       = \u001b[38;5;166mfalse",
                      "FirstCause": false,
                      "LastCause": false
                    },
                    {
                      "Number": 9,
                      "Content": "  block_public_policy     = false",
                      "IsCause": false,
                      "Annotation": "",
                      "Truncated": false,
                      "Highlighted": "\u001b[0m  \u001b[38;5;245mblock_public_policy\u001b[0m     = \u001b[38;5;166mfalse",
                      "FirstCause": false,
                      "LastCause": false
                    },
                    {
                      "Number": 10,
                      "Content": "  ignore_public_acls      = false",
                      "IsCause": false,
                      "Annotation": "",
                      "Truncated": false,
                      "Highlighted": "\u001b[0m  \u001b[38;5;245mignore_public_acls\u001b[0m      = \u001b[38;5;166mfalse",
                      "FirstCause": false,
                      "LastCause": false
                    },
                    {
                      "Number": 11,
                      "Content": "  restrict_public_buckets = false",
                      "IsCause": true,
                      "Annotation": "",
                      "Truncated": false,
                      "Highlighted": "\u001b[0m  \u001b[38;5;245mrestrict_public_buckets\u001b[0m = \u001b[38;5;166mfalse",
                      "FirstCause": true,
                      "LastCause": true
                    },
                    {
                      "Number": 12,
                      "Content": "}",
                      "IsCause": false,
                      "Annotation": "",
                      "Truncated": false,
                      "Highlighted": "\u001b[0m}",
                      "FirstCause": false,
                      "LastCause": false
                    }
                  ]
                },
                "Occurrences": [
                  {
                    "Resource": "aws_s3_bucket_public_access_block.app_bucket",
                    "Filename": "main.tf",
                    "Location": {
                      "StartLine": 5,
                      "EndLine": 12
                    }
                  }
                ]
              }
            },
            {
              "Type": "Terraform Security Check",
              "ID": "aws-vpc-add-description-to-security-group",
              "AVDID": "AVD-AWS-0099",
              "Title": "Missing description for security group.",
              "Description": "Security groups should include a description for auditing purposes.\n\nSimplifies auditing, debugging, and managing security groups.\n",
              "Message": "Security group explicitly uses the default description.",
              "Namespace": "builtin.aws.ec2.aws0099",
              "Query": "data.builtin.aws.ec2.aws0099.deny",
              "Resolution": "Add descriptions for all security groups",
              "Severity": "LOW",
              "PrimaryURL": "https://avd.aquasec.com/misconfig/aws-vpc-add-description-to-security-group",
              "References": [
                "https://www.cloudconformity.com/knowledge-base/aws/EC2/security-group-rules-description.html",
                "https://avd.aquasec.com/misconfig/aws-vpc-add-description-to-security-group"
              ],
              "Status": "FAIL",
              "CauseMetadata": {
                "Resource": "aws_security_group.app_sg",
                "Provider": "AWS",
                "Service": "ec2",
                "StartLine": 14,
                "EndLine": 23,
                "Code": {
                  "Lines": [
                    {
                      "Number": 14,
                      "Content": "resource \"aws_security_group\" \"app_sg\" {",
                      "IsCause": true,
                      "Annotation": "",
                      "Truncated": false,
                      "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_security_group\"\u001b[0m \u001b[38;5;37m\"app_sg\"\u001b[0m {",
                      "FirstCause": true,
                      "LastCause": false
                    },
                    {
                      "Number": 15,
                      "Content": "  name = \"app-sg\"",
                      "IsCause": true,
                      "Annotation": "",
                      "Truncated": false,
                      "Highlighted": "  \u001b[38;5;245mname\u001b[0m = \u001b[38;5;37m\"app-sg\"",
                      "FirstCause": false,
                      "LastCause": false
                    },
                    {
                      "Number": 16,
                      "Content": "",
                      "IsCause": true,
                      "Annotation": "",
                      "Truncated": false,
                      "Highlighted": "\u001b[0m",
                      "FirstCause": false,
                      "LastCause": false
                    },
                    {
                      "Number": 17,
                      "Content": "  ingress {",
                      "IsCause": true,
                      "Annotation": "",
                      "Truncated": false,
                      "Highlighted": "  ingress {",
                      "FirstCause": false,
                      "LastCause": false
                    },
                    {
                      "Number": 18,
                      "Content": "    from_port   = 22",
                      "IsCause": true,
                      "Annotation": "",
                      "Truncated": false,
                      "Highlighted": "    \u001b[38;5;245mfrom_port\u001b[0m   = \u001b[38;5;37m22",
                      "FirstCause": false,
                      "LastCause": false
                    },
                    {
                      "Number": 19,
                      "Content": "    to_port     = 22",
                      "IsCause": true,
                      "Annotation": "",
                      "Truncated": false,
                      "Highlighted": "\u001b[0m    \u001b[38;5;245mto_port\u001b[0m     = \u001b[38;5;37m22",
                      "FirstCause": false,
                      "LastCause": false
                    },
                    {
                      "Number": 20,
                      "Content": "    protocol    = \"tcp\"",
                      "IsCause": true,
                      "Annotation": "",
                      "Truncated": false,
                      "Highlighted": "\u001b[0m    \u001b[38;5;245mprotocol\u001b[0m    = \u001b[38;5;37m\"tcp\"",
                      "FirstCause": false,
                      "LastCause": false
                    },
                    {
                      "Number": 21,
                      "Content": "    cidr_blocks = [\"0.0.0.0/0\"]",
                      "IsCause": true,
                      "Annotation": "",
                      "Truncated": false,
                      "Highlighted": "\u001b[0m    \u001b[38;5;245mcidr_blocks\u001b[0m = [\u001b[38;5;37m\"0.0.0.0/0\"\u001b[0m]",
                      "FirstCause": false,
                      "LastCause": false
                    },
                    {
                      "Number": 22,
                      "Content": "  }",
                      "IsCause": true,
                      "Annotation": "",
                      "Truncated": false,
                      "Highlighted": "  }",
                      "FirstCause": false,
                      "LastCause": false
                    },
                    {
                      "Number": 23,
                      "Content": "}",
                      "IsCause": true,
                      "Annotation": "",
                      "Truncated": false,
                      "Highlighted": "}",
                      "FirstCause": false,
                      "LastCause": true
                    }
                  ]
                }
              }
            },
            {
              "Type": "Terraform Security Check",
              "ID": "AVD-AWS-0107",
              "AVDID": "AVD-AWS-0107",
              "Title": "Security groups should not allow unrestricted ingress to SSH or RDP from any IP address.",
              "Description": "Security groups provide stateful filtering of ingress and egress network traffic to AWS\nresources. It is recommended that no security group allows unrestricted ingress access to\nremote server administration ports, such as SSH to port 22 and RDP to port 3389.\n",
              "Message": "Security group rule allows unrestricted ingress from any IP address.",
              "Namespace": "builtin.aws.ec2.aws0107",
              "Query": "data.builtin.aws.ec2.aws0107.deny",
              "Resolution": "Set a more restrictive CIDR range",
              "Severity": "HIGH",
              "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0107",
              "References": [
                "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/security-group-rules-reference.html",
                "https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html#ec2-13",
                "https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html#ec2-14",
                "https://avd.aquasec.com/misconfig/avd-aws-0107"
              ],
              "Status": "FAIL",
              "CauseMetadata": {
                "Resource": "aws_security_group.app_sg",
                "Provider": "AWS",
                "Service": "ec2",
                "StartLine": 21,
                "EndLine": 21,
                "Code": {
                  "Lines": [
                    {
                      "Number": 14,
                      "Content": "resource \"aws_security_group\" \"app_sg\" {",
                      "IsCause": false,
                      "Annotation": "",
                      "Truncated": false,
                      "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_security_group\"\u001b[0m \u001b[38;5;37m\"app_sg\"\u001b[0m {",
                      "FirstCause": false,
                      "LastCause": false
                    },
                    {
                      "Number": 15,
                      "Content": "  name = \"app-sg\"",
                      "IsCause": false,
                      "Annotation": "",
                      "Truncated": false,
                      "Highlighted": "  \u001b[38;5;245mname\u001b[0m = \u001b[38;5;37m\"app-sg\"",
                      "FirstCause": false,
                      "LastCause": false
                    },
                    {
                      "Number": 16,
                      "Content": "",
                      "IsCause": false,
                      "Annotation": "",
                      "Truncated": false,
                      "Highlighted": "\u001b[0m",
                      "FirstCause": false,
                      "LastCause": false
                    },
                    {
                      "Number": 17,
                      "Content": "  ingress {",
                      "IsCause": false,
                      "Annotation": "",
                      "Truncated": false,
                      "Highlighted": "  ingress {",
                      "FirstCause": false,
                      "LastCause": false
                    },
                    {
                      "Number": 18,
                      "Content": "    from_port   = 22",
                      "IsCause": false,
                      "Annotation": "",
                      "Truncated": false,
                      "Highlighted": "    \u001b[38;5;245mfrom_port\u001b[0m   = \u001b[38;5;37m22",
                      "FirstCause": false,
                      "LastCause": false
                    },
                    {
                      "Number": 19,
                      "Content": "    to_port     = 22",
                      "IsCause": false,
                      "Annotation": "",
                      "Truncated": false,
                      "Highlighted": "\u001b[0m    \u001b[38;5;245mto_port\u001b[0m     = \u001b[38;5;37m22",
                      "FirstCause": false,
                      "LastCause": false
                    },
                    {
                      "Number": 20,
                      "Content": "    protocol    = \"tcp\"",
                      "IsCause": false,
                      "Annotation": "",
                      "Truncated": false,
                      "Highlighted": "\u001b[0m    \u001b[38;5;245mprotocol\u001b[0m    = \u001b[38;5;37m\"tcp\"",
                      "FirstCause": false,
                      "LastCause": false
                    },
                    {
                      "Number": 21,
                      "Content": "    cidr_blocks = [\"0.0.0.0/0\"]",
                      "IsCause": true,
                      "Annotation": "",
                      "Truncated": false,
                      "Highlighted": "\u001b[0m    \u001b[38;5;245mcidr_blocks\u001b[0m = [\u001b[38;5;37m\"0.0.0.0/0\"\u001b[0m]",
                      "FirstCause": true,
                      "LastCause": true
                    },
                    {
                      "Number": 22,
                      "Content": "  }",
                      "IsCause": false,
                      "Annotation": "",
                      "Truncated": false,
                      "Highlighted": "  }",
                      "FirstCause": false,
                      "LastCause": false
                    },
                    {
                      "Number": 23,
                      "Content": "}",
                      "IsCause": false,
                      "Annotation": "",
                      "Truncated": false,
                      "Highlighted": "}",
                      "FirstCause": false,
                      "LastCause": false
                    }
                  ]
                },
                "Occurrences": [
                  {
                    "Resource": "ingress",
                    "Filename": "main.tf",
                    "Location": {
                      "StartLine": 17,
                      "EndLine": 22
                    }
                  },
                  {
                    "Resource": "aws_security_group.app_sg",
                    "Filename": "main.tf",
                    "Location": {
                      "StartLine": 14,
                      "EndLine": 23
                    }
                  }
                ]
              }
            },
            {
              "Type": "Terraform Security Check",
              "ID": "aws-vpc-add-description-to-security-group-rule",
              "AVDID": "AVD-AWS-0124",
              "Title": "Missing description for security group rule.",
              "Description": "Security group rules should include a description for auditing purposes.\n\nSimplifies auditing, debugging, and managing security groups.\n",
              "Message": "Security group rule does not have a description.",
              "Namespace": "builtin.aws.ec2.aws0124",
              "Query": "data.builtin.aws.ec2.aws0124.deny",
              "Resolution": "Add descriptions for all security groups rules",
              "Severity": "LOW",
              "PrimaryURL": "https://avd.aquasec.com/misconfig/aws-vpc-add-description-to-security-group-rule",
              "References": [
                "https://www.cloudconformity.com/knowledge-base/aws/EC2/security-group-rules-description.html",
                "https://avd.aquasec.com/misconfig/aws-vpc-add-description-to-security-group-rule"
              ],
              "Status": "FAIL",
              "CauseMetadata": {
                "Resource": "aws_security_group.app_sg",
                "Provider": "AWS",
                "Service": "ec2",
                "StartLine": 17,
                "EndLine": 22,
                "Code": {
                  "Lines": [
                    {
                      "Number": 14,
                      "Content": "resource \"aws_security_group\" \"app_sg\" {",
                      "IsCause": false,
                      "Annotation": "",
                      "Truncated": false,
                      "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_security_group\"\u001b[0m \u001b[38;5;37m\"app_sg\"\u001b[0m {",
                      "FirstCause": false,
                      "LastCause": false
                    },
                    {
                      "Number": 15,
                      "Content": "  name = \"app-sg\"",
                      "IsCause": false,
                      "Annotation": "",
                      "Truncated": false,
                      "Highlighted": "  \u001b[38;5;245mname\u001b[0m = \u001b[38;5;37m\"app-sg\"",
                      "FirstCause": false,
                      "LastCause": false
                    },
                    {
                      "Number": 16,
                      "Content": "",
                      "IsCause": false,
                      "Annotation": "",
                      "Truncated": false,
                      "Highlighted": "\u001b[0m",
                      "FirstCause": false,
                      "LastCause": false
                    },
                    {
                      "Number": 17,
                      "Content": "  ingress {",
                      "IsCause": true,
                      "Annotation": "",
                      "Truncated": false,
                      "Highlighted": "  ingress {",
                      "FirstCause": true,
                      "LastCause": false
                    },
                    {
                      "Number": 18,
                      "Content": "    from_port   = 22",
                      "IsCause": true,
                      "Annotation": "",
                      "Truncated": false,
                      "Highlighted": "    \u001b[38;5;245mfrom_port\u001b[0m   = \u001b[38;5;37m22",
                      "FirstCause": false,
                      "LastCause": false
                    },
                    {
                      "Number": 19,
                      "Content": "    to_port     = 22",
                      "IsCause": true,
                      "Annotation": "",
                      "Truncated": false,
                      "Highlighted": "\u001b[0m    \u001b[38;5;245mto_port\u001b[0m     = \u001b[38;5;37m22",
                      "FirstCause": false,
                      "LastCause": false
                    },
                    {
                      "Number": 20,
                      "Content": "    protocol    = \"tcp\"",
                      "IsCause": true,
                      "Annotation": "",
                      "Truncated": false,
                      "Highlighted": "\u001b[0m    \u001b[38;5;245mprotocol\u001b[0m    = \u001b[38;5;37m\"tcp\"",
                      "FirstCause": false,
                      "LastCause": false
                    },
                    {
                      "Number": 21,
                      "Content": "    cidr_blocks = [\"0.0.0.0/0\"]",
                      "IsCause": true,
                      "Annotation": "",
                      "Truncated": false,
                      "Highlighted": "\u001b[0m    \u001b[38;5;245mcidr_blocks\u001b[0m = [\u001b[38;5;37m\"0.0.0.0/0\"\u001b[0m]",
                      "FirstCause": false,
                      "LastCause": false
                    },
                    {
                      "Number": 22,
                      "Content": "  }",
                      "IsCause": true,
                      "Annotation": "",
                      "Truncated": false,
                      "Highlighted": "  }",
                      "FirstCause": false,
                      "LastCause": true
                    },
                    {
                      "Number": 23,
                      "Content": "}",
                      "IsCause": false,
                      "Annotation": "",
                      "Truncated": false,
                      "Highlighted": "}",
                      "FirstCause": false,
                      "LastCause": false
                    }
                  ]
                },
                "Occurrences": [
                  {
                    "Resource": "aws_security_group.app_sg",
                    "Filename": "main.tf",
                    "Location": {
                      "StartLine": 14,
                      "EndLine": 23
                    }
                  }
                ]
              }
            },
            {
              "Type": "Terraform Security Check",
              "ID": "AVD-AWS-0132",
              "AVDID": "AVD-AWS-0132",
              "Title": "S3 encryption should use Customer Managed Keys",
              "Description": "Encryption using AWS keys provides protection for your S3 buckets. To increase control of the encryption and manage factors like rotation use customer managed keys.\n",
              "Message": "Bucket does not encrypt data with a customer managed key.",
              "Namespace": "builtin.aws.s3.aws0132",
              "Query": "data.builtin.aws.s3.aws0132.deny",
              "Resolution": "Enable encryption using customer managed keys",
              "Severity": "HIGH",
              "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0132",
              "References": [
                "https://docs.aws.amazon.com/AmazonS3/latest/userguide/bucket-encryption.html",
                "https://avd.aquasec.com/misconfig/avd-aws-0132"
              ],
              "Status": "FAIL",
              "CauseMetadata": {
                "Resource": "aws_s3_bucket.app_bucket",
                "Provider": "AWS",
                "Service": "s3",
                "StartLine": 1,
                "EndLine": 3,
                "Code": {
                  "Lines": [
                    {
                      "Number": 1,
                      "Content": "resource \"aws_s3_bucket\" \"app_bucket\" {",
                      "IsCause": true,
                      "Annotation": "",
                      "Truncated": false,
                      "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"app_bucket\"\u001b[0m {",
                      "FirstCause": true,
                      "LastCause": false
                    },
                    {
                      "Number": 2,
                      "Content": "  bucket = \"my-app-bucket\"",
                      "IsCause": true,
                      "Annotation": "",
                      "Truncated": false,
                      "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"my-app-bucket\"",
                      "FirstCause": false,
                      "LastCause": false
                    },
                    {
                      "Number": 3,
                      "Content": "}",
                      "IsCause": true,
                      "Annotation": "",
                      "Truncated": false,
                      "Highlighted": "\u001b[0m}",
                      "FirstCause": false,
                      "LastCause": true
                    }
                  ]
                }
              }
            }
          ]
        }
      ]
    }
  },
  "metadata": {
    "scanStartedOn": "2025-11-12T20:01:10.768645689Z",
    "scanFinishedOn": "2025-11-12T20:01:10.768645689Z"
  }
}
}
